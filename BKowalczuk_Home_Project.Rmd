---
title: "Put Down-and-In Option"
author: "Bartlomiej Kowalczuk"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Rcpp)
library(ggplot2)
```

In Put Down-and-In option we want the price to decrease and reach the barrier to activate.

### Install package and load library
This library consists of one C++ function for Monte Carlo simulation.
```{r}
if (!require("BKput")) install.packages("BKput.zip", type = "binaries", repos = NULL)

library(blawok)

```

Build functions for simulations:

```{r}
getPutPriceExp <- function(expiry) {
   return(getPutDownAndIn(nInt = 3000, Expiry = expiry, nReps = 100))
}

getPutPriceVol <- function(Volatility) {
   return(getPutDownAndIn(nInt = 3000, Vol = Volatility, nReps = 100))
}

# getPutPriceExpVol <- function(expiry, Volatility) {
#    return(getPutDownAndIn(nInt = 3000, Volatility = Volatility, Expiry = expiry, nReps = 100))
# }

```

First of all we want to check how the option behaves on different time to maturity levels.

```{r, fig.align='center'}
# arguments values of values of function
# expiry <- seq(0.01, 0.7, by = 0.001)
# resultE <- sapply(expiry, getPutPriceExp)
# 
# # plot
# qplot(x = expiry,
#       y = resultE,
#       xlab = "time to maturity",
#       ylab = "Price of European put option",
#       main = "Price of European put option vs. time to maturity",
#       colour = I("#4E84C4")
#       )


```


Inferring from the chart we can assume that the higher the time to maturity the higher would the price be.

Next, we will check how the option price behaves on differnet volatility levels.

```{r, fig.align='center'}
# arguments values of values of function
# Vol <- seq(0.1, 0.3, by = 0.001)
# resultV <- sapply(Vol, getPutPriceVol)
# 
# # plot 
# qplot(x = Vol,
#       y = resultV,
#       xlab = "Volatility",
#       ylab = "Price of European put option",
#       main = "Price of European put option vs. Volatility",
#       colour = I("#00AFBB"))

```

We want the price to reach the barrier, so we want the volatility to be as high as possible.The relation is not constant but overall it is a rising trend. We may say that the higher the volatility the higher the price can get. 

How would the relation look if we investigate it using both factors?

```{r, fig.align='center'}
Vol <- seq(0.1, 0.7, by = 0.001)
expiry <- seq(0.1, 0.7, by = 0.001)

resultV <- sapply(Vol, getPutPriceVol)
resultE <- sapply(expiry, getPutPriceExp)

# plot
p <- qplot(x = Vol,
      y = resultV,
      xlab = "Volatility",
      ylab = "Price of European put option",
      main = "Price of European put option vs. Volatility",
      colour = I("#00AFBB")) 

p + geom_point(x = Vol, y = resultE,color='steelblue')

```
